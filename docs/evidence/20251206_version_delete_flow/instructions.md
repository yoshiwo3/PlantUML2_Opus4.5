# 作業指示書: 3.7/3.8 業務フロー図作成 + データ保存設計

**作成日**: 2025-12-06
**作業者**: Claude Opus 4.5
**ステータス**: 完了

---

## 目標

1. **3.7 バージョン管理フロー**（UC 3-7, 3-8）の作成
2. **3.8 図表削除フロー**（UC 3-9）の作成
3. **データ保存設計の決定**（追加）

---

## コンテキスト

### 対応ユースケース

| UC ID | ユースケース名 | 関連フロー |
|-------|---------------|-----------|
| UC 3-7 | バージョン履歴を確認する | 3.7 |
| UC 3-8 | 過去バージョンを復元する | 3.7 |
| UC 3-9 | 図表を削除する | 3.8 |

### 前提条件（修正）

- ~~PlantUML専用機能（Excalidrawはバージョン管理非対応）~~ → **PlantUML/Excalidraw両方対応**に設計変更
- ~~SHA-256ハッシュでバージョン識別~~ → **バージョン管理はv3に延期**
- 既存フロー（3.1〜3.6）との整合性を保つ

---

## 実施内容

### Part 1: 業務フロー図作成

1. [x] Context7でPlantUML構文確認
2. [x] 3.7 バージョン管理フロー作成
   - 3.7.1 履歴確認フロー（UC 3-7）
   - 3.7.2 バージョン復元フロー（UC 3-8）
3. [x] 3.8 図表削除フロー作成（UC 3-9）
4. [x] PlantUMLバリデーション実行
5. [x] 業務フロー図ドキュメントに追記
6. [x] active_context.md更新

### Part 2: 設計変更対応

7. [x] Excalidrawバージョン管理対応（設計変更）
   - 業務フロー図3.7をPlantUML/Excalidraw両対応に修正
   - ユースケース図: UC 3-7, 3-8を「共通」に変更
   - パッケージ構成: 3-B. 出力・管理（共通）に移動
8. [x] docs/proposals整合性チェック（全5ファイル）
   - コンテキスト図: Excalidraw Serviceにバージョン管理追加
9. [x] PlantUML専用機能の妥当性確認
   - UC 3-4「プレビュー」: PlantUML専用で妥当（ExcalidrawはWYSIWYG）
   - UC 3-10, 3-11「学習コンテンツ」: PlantUML専用で妥当（構文学習）

### Part 3: データ保存設計の決定

10. [x] バージョン管理の実現可能性を検討
11. [x] データ保存形式の検討（DB vs Storage）
12. [x] 機能ロードマップの決定（MVP / v3）
13. [x] ファイル形式の決定（B案: .puml + コメント内Markdown）

---

## 完了条件

- [x] PlantUMLコードが正常にレンダリングされる
- [x] 既存フローとの整合性が確認される
- [x] ユースケースカバレッジ: 3-7, 3-8, 3-9 がカバー済みになる
- [x] active_context.md が更新される
- [x] docs/proposals全体の整合性が確保される
- [x] データ保存設計が決定される（追加）
