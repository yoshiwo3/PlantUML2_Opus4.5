# UI設計図表 知見ベース

**バージョン**: 1.0
**最終更新**: 2025-12-22
**関連憲法**: UI設計図表開発憲法 v3.0

---

## 概要

本ドキュメントはUI設計図表（ワイヤーフレーム・画面遷移図）作成時に獲得した知見を蓄積・共有するためのナレッジベースである。

PlantUML開発憲法の `Activation_Bar_Knowledge_Base.md` に相当する位置づけ。

---

## 目次

| セクション | 内容 |
|-----------|------|
| [Excalidraw知見](#excalidraw知見) | ワイヤーフレーム作成時の知見（EX-001〜） |
| [State Diagram知見](#state-diagram知見) | 画面遷移図作成時の知見（SD-001〜） |
| [TD-015適用知見](#td-015適用知見) | TD-015原則の具体的適用事例（TD-001〜） |
| [整合性チェック知見](#整合性チェック知見) | 3点対比確認等の知見（IC-001〜） |

---

## Excalidraw知見

### EX-001: Roughnessと手書き感のバランス

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | ワイヤーフレーム作成時、Roughness設定で迷った |
| **知見** | Roughness 0は「きれいすぎ」、Roughness 3は「乱れすぎ」。Roughness 1-2が最適 |
| **推奨設定** | Roughness: 1（シンプルな図形）、Roughness: 2（複雑な図形） |

### EX-002: フォント選択の影響

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | ラベルテキストの可読性とTD-015準拠のバランス |
| **知見** | システムフォントは「完成品感」が出てしまう。Hand-drawn fontを使用すべき |
| **注意点** | Hand-drawn fontは小さいサイズで可読性が下がる。最小16pxを推奨 |

### EX-003: 背景色とコントラスト

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | グレースケール環境での視認性確保 |
| **知見** | 背景なし or #F5F5F5程度の薄いグレーが最適。#FFFFFF（純白）は避ける |
| **理由** | 純白背景は「完成品感」が出る。薄いグレーは「下書き感」を維持 |

### EX-004: PNG/SVGエクスポート時の注意点

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | エクスポート後のファイルサイズ・品質 |
| **知見** | SVGはベクター形式で拡大縮小に強い。PNGはレビュー用に適切 |
| **推奨** | レビュー時: PNG（2x解像度）、正式版: SVG |

### EX-005: （テンプレート - 新規知見追加用）

| 項目 | 内容 |
|------|------|
| **発見日** | YYYY-MM-DD |
| **状況** | （発見状況を記載） |
| **知見** | （獲得した知見を記載） |
| **推奨** | （推奨される対応を記載） |

---

## State Diagram知見

### SD-001: 開始点・終了点の必須化

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | 画面遷移図で開始点がないと警告される |
| **知見** | PlantUML state diagramでは `[*] --> State` と `State --> [*]` が必須ではないが、UI設計では必須とすべき |
| **理由** | ユーザーがどこから開始し、どこで終了するかを明示するため |

### SD-002: 複合状態（ネスト）の活用

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | 画面数が多い場合のグルーピング |
| **知見** | `state Name { ... }` で関連画面をグループ化可能。例: 認証画面群、設定画面群 |
| **注意点** | ネストは2階層まで。3階層以上は可読性が低下 |

### SD-003: 遷移ラベルの命名規則

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | 遷移トリガー（ラベル）の書き方 |
| **知見** | 動詞形で統一。「クリック」ではなく「ログイン」「保存」など操作の結果を記載 |
| **例** | `login --> dashboard : ログイン成功` ではなく `login --> dashboard : ログイン` |

### SD-004: 色分けとskinparam

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | 画面カテゴリの視覚的区別 |
| **知見** | `skinparam state { BackgroundColor<<tag>> #COLOR }` で状態に色を付けられる |
| **推奨色** | 認証: #FFFDE7（黄）、メイン: #E3F2FD（青）、モーダル: #E8F5E9（緑） |

### SD-005: 手書き風オプション

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | TD-015準拠のための設定 |
| **知見** | `!option handwritten true` を先頭に追加すると手書き風になる |
| **注意点** | 複雑な図では若干読みにくくなる場合あり。バランスを考慮 |

### SD-006: 矢印交差問題（実体験: 2025-12-22）

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | 19ノード（4グループ）の画面遷移図を作成し、PNG生成後に視覚確認 |
| **問題** | グループ間遷移（認証→メイン、メイン→モーダル、メイン→管理）の矢印が複雑に交差し、視認性が低下 |
| **原因** | PlantUMLの自動レイアウトでは、多数のグループ間遷移を最適配置できない |
| **知見** | 19ノード以上の複雑な遷移図では、グループ間遷移の矢印が交差する可能性が高い |
| **推奨** | 1. 遷移図を分割（認証フロー、メインフロー等）を検討<br/>2. 矢印のスタイル（破線等）で区別する |
| **エビデンス** | `docs/proposals/diagrams/09_screen_transition/PlantUML_Studio_Screen_Transition.png` |

### SD-007: モーダル群のノード密集問題（実体験: 2025-12-22）

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | モーダル群として8つのモーダル画面をグループ化 |
| **問題** | 8ノードが横並びになり、ラベルが読みにくくなった |
| **原因** | PlantUMLは複合状態内のノードを自動配置するが、多数ノードでは密集する |
| **知見** | 1つのグループ内のノード数は5〜6以下が推奨。超える場合はサブグループ化を検討 |
| **推奨** | モーダルを機能別にサブグループ化: <br/>- プロジェクト系（作成、編集、削除確認）<br/>- 図表系（作成、テンプレート、エクスポート、削除確認）<br/>- AI系（AIチャット） |
| **エビデンス** | `docs/proposals/diagrams/09_screen_transition/PlantUML_Studio_Screen_Transition.png` |

### SD-008: （テンプレート - 新規知見追加用）

| 項目 | 内容 |
|------|------|
| **発見日** | YYYY-MM-DD |
| **状況** | （発見状況を記載） |
| **知見** | （獲得した知見を記載） |
| **推奨** | （推奨される対応を記載） |

---

## TD-015適用知見

### TD-001: 「低精度」の具体的基準

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | 「低精度」がどの程度かの判断 |
| **知見** | 1画面15分以内で作成できるレベルが「低精度」の目安 |
| **チェック** | 30分以上かけていたら「やりすぎ」の可能性 |

### TD-002: グラデーション・影の完全禁止

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | ボタンやカードに影を付けたくなる誘惑 |
| **知見** | グラデーション・ドロップシャドウは絶対禁止。フラットなグレー単色のみ |
| **理由** | 「デザイン」の議論を避け、「機能配置」の議論に集中するため |

### TD-003: アイコン使用の制限

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | アイコンをどこまで描くか |
| **知見** | 簡易記号（🔍、📁、⚙️等）は可。複雑なカスタムアイコンは禁止 |
| **理由** | アイコンデザインは設計フェーズで決定すべき |

### TD-004: （テンプレート - 新規知見追加用）

| 項目 | 内容 |
|------|------|
| **発見日** | YYYY-MM-DD |
| **状況** | （発見状況を記載） |
| **知見** | （獲得した知見を記載） |
| **推奨** | （推奨される対応を記載） |

---

## 整合性チェック知見

### IC-001: 3点対比確認の重要性

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | ワイヤーフレームと遷移図の不整合 |
| **知見** | 「画面一覧」「ワイヤーフレーム」「遷移図ノード」の3点が1:1対応していることを確認必須 |
| **手順** | 1. 画面一覧作成 → 2. 一覧の全画面にワイヤーフレーム作成 → 3. 全画面を遷移図にノード化 |

### IC-002: モーダル・ダイアログの扱い

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | モーダルは「画面」として扱うか |
| **知見** | モーダル・ダイアログも画面として抽出し、遷移図にノードとして含める |
| **理由** | ユーザーの視点では別画面に見える。遷移を明示するため |

### IC-003: 孤立ノードの発見方法

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | PNG視覚確認で孤立ノードを見落とした |
| **知見** | 「入力矢印なし」「出力矢印なし」の両方を別々にチェックする |
| **手順** | Pass 1: 各ノードに入力があるか確認 → Pass 2: 各ノードに出力があるか確認 |

### IC-004: UC図からの画面抽出プロセス（実体験: 2025-12-22）

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | 32UC（5パッケージ）から画面一覧を抽出し、遷移図を作成 |
| **実施内容** | 1. UC図読込 → 2. 業務フロー図読込 → 3. 画面抽出 → 4. カテゴリ分類 → 5. 遷移図作成 |
| **知見** | UCと画面は1:1対応ではない。複数UCが1画面に集約されるケース（エディタ画面: UC 3-1〜3-6, 4-1〜4-2）と、1UCが複数画面に分散されるケース（管理機能群）がある |
| **推奨** | UC図だけでなく業務フロー図も参照して画面を抽出すべき。業務フローから「ユーザーが見る画面」を特定する |
| **結果** | 32UC → 19画面（認証3、メイン3、モーダル8、管理5） |
| **エビデンス** | 作成した遷移図: `docs/proposals/diagrams/09_screen_transition/99_screen_transition.puml` |

### IC-005: ノード内情報量の制御（実体験: 2025-12-22）

| 項目 | 内容 |
|------|------|
| **発見日** | 2025-12-22 |
| **状況** | 各ノードにUC番号と機能概要を記載し、PNG生成後に確認 |
| **問題** | ノード内の情報が多すぎると、特に小さいノードでテキストが重なり視認性が低下 |
| **知見** | 1ノードあたりの情報は2-3行が限界。UC番号 + 1行説明が適切 |
| **推奨** | 詳細情報はノート（note）を使用して分離する |
| **エビデンス** | `docs/proposals/diagrams/09_screen_transition/PlantUML_Studio_Screen_Transition.png` |

### IC-006: （テンプレート - 新規知見追加用）

| 項目 | 内容 |
|------|------|
| **発見日** | YYYY-MM-DD |
| **状況** | （発見状況を記載） |
| **知見** | （獲得した知見を記載） |
| **推奨** | （推奨される対応を記載） |

---

## 知見追加プロセス

新しい知見を発見した場合、以下の手順で追加する：

1. **該当セクションを特定**
   - Excalidraw関連 → EX-XXX
   - State Diagram関連 → SD-XXX
   - TD-015関連 → TD-XXX
   - 整合性チェック関連 → IC-XXX

2. **テンプレートをコピー**
   - 各セクション末尾のテンプレート（EX-005, SD-006等）をコピー

3. **内容を記入**
   - 発見日、状況、知見、推奨の4項目を記入

4. **番号を更新**
   - 新しい知見に連番を付与
   - テンプレートの番号をインクリメント

5. **憲法への反映を検討**
   - 重要な知見は `UI_Design_Constitution.md` の該当セクションにも追記

---

## 関連ドキュメント

| ドキュメント | 内容 |
|-------------|------|
| `UI_Design_Constitution.md` | UI設計図表開発憲法（本知見ベースの親ドキュメント） |
| `UI_Design_Constitution_Upgrade_Strategy.md` | 品質同等化戦略 |
| `.serena/memories/wireframe_research_td015_decision_2025-11-26_29.md` | TD-015意思決定記録 |
| `docs/guides/PlantUML_Development_Constitution.md` | PlantUML開発憲法（参考） |
| `docs/guides/sequence_diagram/Activation_Bar_Knowledge_Base.md` | アクティブバー知見ベース（参考） |

---

## ケーススタディ

### CS-001: 初回画面遷移図作成（19ノード4グループ）

| 項目 | 内容 |
|------|------|
| **実施日** | 2025-12-22 |
| **対象** | PlantUML Studio 全画面遷移図 |
| **入力** | UC図（32UC）、業務フロー図（11フロー） |
| **出力** | `99_screen_transition.puml`（19ノード、4グループ） |

#### 作業プロセス

| ステップ | 内容 | 所要時間（推定） |
|:--------:|------|:--------------:|
| 1 | UC図読込・分析 | 5分 |
| 2 | 業務フロー図読込・画面抽出 | 10分 |
| 3 | 画面カテゴリ分類（auth/main/modal/admin） | 5分 |
| 4 | PlantUML構文確認（Context7 + 公式ドキュメント） | 10分 |
| 5 | pumlファイル作成 | 20分 |
| 6 | PNG生成 | 1分 |
| 7 | 5パスレビュー | 10分 |
| **合計** | | **約60分** |

#### 発見した問題

| # | 問題 | 知見ID | 対応状況 |
|:-:|------|:------:|:--------:|
| 1 | 矢印の交差が多い | SD-006 | 知見記録 |
| 2 | モーダル8ノード密集 | SD-007 | 知見記録 |
| 3 | ノード内情報過多 | IC-005 | 知見記録 |

#### 得られた知見サマリー

| カテゴリ | 追加知見数 | ID |
|---------|:--------:|-----|
| State Diagram | 2 | SD-006, SD-007 |
| 整合性チェック | 2 | IC-004, IC-005 |
| **合計** | **4** | |

#### 品質評価

| 観点 | 評価 | コメント |
|------|:----:|---------|
| TD-015準拠 | ✅ | handwritten true適用 |
| 網羅性 | ✅ | 32UC → 19画面マッピング完了 |
| UC対応 | ✅ | 全ノードにUC番号記載 |
| 視認性 | 🟡 | 矢印交差・密集問題あり |

#### 結論

初回作成で4つの実体験知見を獲得。次回作成時は以下を改善予定：
1. モーダル群をサブグループ化
2. グループ間遷移の矢印スタイル変更
3. ノード内情報量の削減

---

## 更新履歴

| 日付 | Ver | 内容 |
|------|:---:|------|
| 2025-12-22 | 1.1 | 実体験知見追加（SD-006〜007, IC-004〜005）、CS-001追加 |
| 2025-12-22 | 1.0 | 初版作成（EX-001〜004, SD-001〜005, TD-001〜003, IC-001〜003） |
