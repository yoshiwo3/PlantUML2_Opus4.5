# UI設計図表作成ガイドライン

**作成日**: 2025-12-22
**対象**: ワイヤーフレーム・画面遷移図
**根拠**: UI設計図表開発憲法 v3.3

---

## 目的

本ガイドラインは、UI設計図表（ワイヤーフレーム・画面遷移図）を作成する際に、後から修正が必要にならないよう、事前に留意すべき点をまとめたものです。

---

## 1. TD-015原則の遵守（最重要）

### ルール

**UI設計図表は「低精度（Low-Fidelity）」「手書き風」「グレースケール」の3原則を必ず満たすこと。**

### 正しいパターン

| 原則 | 適用方法 |
|------|---------|
| **低精度** | 1画面15分以内で作成、詳細な装飾なし |
| **手書き風** | Excalidraw標準スタイル、Roughness 1-2 |
| **グレースケール** | 白・グレー・黒のみ、カラー禁止 |

### 禁止パターン

| 禁止事項 | 理由 |
|---------|------|
| グラデーション | 「デザイン」議論を誘発 |
| ドロップシャドウ | 高精度の印象を与える |
| カラー使用 | 配色議論は設計フェーズで行う |
| ピクセル完璧 | 実装詳細に踏み込みすぎ |
| 複雑なアイコン | 簡易記号のみ許可 |

---

## 2. Excalidrawスタイル設定（ワイヤーフレーム）

### 必須設定

```json
{
  "strokeColor": "#1e1e1e",
  "backgroundColor": "#f5f5f5",
  "fillStyle": "solid",
  "strokeWidth": 1,
  "roughness": 1,
  "opacity": 100,
  "fontFamily": 1,
  "fontSize": 16,
  "textAlign": "center",
  "verticalAlign": "middle"
}
```

### 要素別推奨設定

| 要素 | Roughness | Fill | 備考 |
|------|:---------:|------|------|
| コンテナ（画面枠） | 1 | #ffffff | 外枠は太め（strokeWidth: 2） |
| ボタン | 1 | #e0e0e0 | グレー背景 |
| テキスト入力 | 0 | #ffffff | 直線的に |
| ラベル | - | なし | Hand-drawn font、16px以上 |
| 区切り線 | 1 | - | 破線使用可 |

---

## 3. PlantUML画面遷移図の構文

### 必須ヘッダー

```plantuml
@startuml PlantUML_Studio_Screen_Transition
'==================================================
' 画面遷移図: PlantUML Studio
' 対象: 全画面（認証/メイン/モーダル/管理）
' 基準: UC図、業務フロー図
'==================================================

skinparam state {
    BackgroundColor #F5F5F5
    BorderColor #666666
    FontColor #333333
}

skinparam state<<auth>> {
    BackgroundColor #FFFDE7
}

skinparam state<<main>> {
    BackgroundColor #E3F2FD
}

skinparam state<<modal>> {
    BackgroundColor #E8F5E9
}
```

### 必須構造

```plantuml
[*] --> ログイン画面 : 初回アクセス

state "認証画面群" as auth {
    state "ログイン画面" as login <<auth>>
    state "新規登録画面" as signup <<auth>>
}

state "メイン画面群" as main {
    state "ダッシュボード" as dashboard <<main>>
    state "エディタ画面" as editor <<main>>
}

login --> dashboard : ログイン成功
dashboard --> editor : 図表選択
editor --> [*] : ログアウト

@enduml
```

---

## 4. 命名規則

### 4.1 ワイヤーフレームファイル

```
NN_<category>_<screen_name>.excalidraw
```

| 要素 | ルール | 例 |
|------|--------|-----|
| NN | 2桁ゼロ埋め連番 | 01, 02, 10 |
| category | 画面カテゴリ（auth/main/modal/admin） | auth |
| screen_name | スネークケース | login, project_list |

**予定ファイル一覧**:

| # | ファイル名 | 画面名 |
|:-:|-----------|--------|
| 01 | `01_auth_login.excalidraw` | ログイン画面 |
| 02 | `02_auth_signup.excalidraw` | 新規登録画面 |
| 03 | `03_main_dashboard.excalidraw` | ダッシュボード |
| 04 | `04_main_editor.excalidraw` | エディタ画面 |
| 05 | `05_main_project_list.excalidraw` | プロジェクト一覧 |

### 4.2 エクスポートファイル

```
NN_<category>_<screen_name>-Review.png   # レビュー用
NN_<category>_<screen_name>.svg          # 正式版
```

### 4.3 画面遷移図

```
99_screen_transition.puml   # PlantUMLソース
99_screen_transition.svg    # 正式版
```

### 4.4 ファイル構成（EX-005 Embedded Index Pattern）

ワイヤーフレームの閲覧と編集を分離するパターン。

```
wireframes/
├── 00_wireframe_index.md      ← 閲覧用（埋め込み一覧）
├── 01_login/
│   └── default.excalidraw     ← 編集用（基本状態）
├── 02_dashboard/
│   ├── default.excalidraw
│   └── search_active.excalidraw  ← 編集用（派生状態）
└── ...
```

| ファイル | 役割 |
|---------|------|
| `00_wireframe_index.md` | 閲覧用（`![[file.excalidraw]]` で埋め込み一覧）|
| `XX_screen/default.excalidraw` | 編集用（個別ファイル）|
| `XX_screen/<state>.excalidraw` | 編集用（派生状態）|

> **詳細**: UI_Design_Knowledge_Base.md §EX-005

### 4.5 フォルダ命名規則（番号プレフィックス方式）

ワイヤーフレームのフォルダ名には**番号プレフィックス方式**を採用する。

#### 採用・却下の経緯

| 方式 | 例 | 採否 | 理由 |
|------|-----|:----:|------|
| カテゴリ別 | `main/`, `modal/`, `admin/` | ❌ 却下 | ファイラーでの並び順が不定、画面遷移図との対応不明確 |
| 番号プレフィックス | `01_login/`, `02_dashboard/` | ✅ 採用 | 並び順保証、遷移図との対応明確、新規追加時の番号割当が容易 |

#### 番号割当ルール

| 範囲 | 用途 | 例 |
|------|------|-----|
| 00 | インデックス | `00_wireframe_index.md` |
| 01-09 | 認証画面群 | `01_login/` |
| 10-19 | メイン画面群 | `10_dashboard/`, `11_editor/` |
| 20-29 | モーダル群 | `20_project_create/` |
| 30-39 | 管理画面群 | `30_admin_dashboard/` |
| 40-49 | 学習コンテンツ群 | `40_learning_content/` |

> **詳細**: 00_raw_notes.md の意思決定#1参照

### 4.6 TD-015準拠 設定値一覧

Excalidrawワイヤーフレームで使用する具体的な設定値。

#### 色設定（グレースケール）

| 用途 | カラーコード | 備考 |
|------|:-----------:|------|
| 背景色（画面） | `#ffffff` | 白 |
| 背景色（薄） | `#f5f5f5` | 薄グレー |
| 枠線色 | `#1e1e1e` | 黒 |
| テキスト色 | `#1e1e1e` | 黒 |
| サブテキスト色 | `#6b7280` | グレー |
| ボタン背景 | `#e0e0e0` | 中グレー |
| 非活性要素 | `#9ca3af` | 薄グレー |

#### スタイル設定

| 項目 | 推奨値 | 説明 |
|------|:------:|------|
| roughness | 1 | 手書き風（0=直線的、2=粗い） |
| strokeStyle | solid | 実線 |
| strokeWidth | 1 | 通常線（外枠は2） |
| fillStyle | solid | 塗りつぶし |
| fontFamily | 1 | Hand-drawn |
| fontSize | 16 | 最小サイズ（これ以下は可読性低下） |
| opacity | 100 | 不透明 |

> **参照**: UI_Design_Knowledge_Base.md §EX-001〜EX-003

---

## 5. 整合性確認（3点対比）

### ルール

**「画面一覧」「ワイヤーフレーム」「遷移図ノード」の3点が1:1対応していることを確認すること。**

### 確認手順

1. **画面一覧テンプレート**で全画面をリストアップ
2. 各画面に対応する**ワイヤーフレーム**が存在するか確認
3. 各画面が**遷移図ノード**として存在するか確認

### 整合性確認テーブル（必須）

```markdown
| 画面名 | ワイヤーフレーム | 遷移図ノード | 対応UC |
|--------|:---------------:|:------------:|--------|
| ログイン画面 | ✅ 01_auth_login | ✅ login | UC 1-1 |
| ダッシュボード | ✅ 03_main_dashboard | ✅ dashboard | UC 2-1 |
| エディタ画面 | 🔴 未作成 | ✅ editor | UC 3-1〜3-6 |
```

### 孤立ノードチェック（遷移図）

- [ ] 全ノードに**入力矢印**があるか（開始点除く）
- [ ] 全ノードに**出力矢印**があるか（終了点除く）
- [ ] 到達不能な画面がないか

---

## 6. チェックリスト（作成前に確認）

### 論理的妥当性検証（LV-001: 最優先）

> **⚠️ 最重要**: 以下の検証をUI要素追加・配置の**最初**に実施すること。
> パターン知識（EX/SD/TD）の適用は、論理的妥当性検証の**後**に行う。

#### 4段階検証フロー

```
Phase 1: 機能分析
  └→ 「この画面で提供すべき機能は何か？」をリストアップ

Phase 2: 一意性検証（P1）
  └→ 「同じ機能を提供するUI要素が複数ないか？」

Phase 3: 必要性論証（P2, P3）
  └→ 「このUI要素は論理的に必要か？」
  └→ 「追加することでユーザーの認知負荷が増えないか？」

Phase 4: 整合性検証（P4）
  └→ 「現在の画面状態から、この操作が出現することは自然か？」
```

#### 論理的妥当性チェックリスト（必須）

- [ ] **P1 機能一意性**: 同じ機能を複数UIで提供していないか
- [ ] **P2 論理整合性**: UI要素間に論理的矛盾がないか
- [ ] **P3 認知負荷最小化**: 不要な選択肢を追加していないか
- [ ] **P4 状態-行動一貫性**: 現在状態から導かれる行動が自然か

#### 違反例と対処

| 違反パターン | 問題 | 対処 |
|-------------|------|------|
| 検索バー＋検索モーダル | P1・P2違反（機能重複＋論理矛盾）| どちらか1つに統一 |
| 常時表示の詳細設定 | P3違反（認知負荷増加）| 必要時のみ表示（モーダル/アコーディオン）|
| 編集中に削除ボタン強調 | P4違反（状態-行動不一致）| 保存ボタンを強調 |

> **詳細**: UI_Design_Knowledge_Base.md §LV-001参照

### UI一貫性検証（LV-002: 新規画面作成前必須）

新規画面作成前に、既存画面との一貫性を検証する。

#### 4原則（Consistency Principles）

| # | 原則名 | 定義 | 検証内容 |
|:-:|--------|------|----------|
| C1 | **視覚的一貫性** | 色・タイポグラフィ・間隔の統一 | strokeColor, backgroundColor, roughness |
| C2 | **構造的一貫性** | レイアウトパターンの統一 | ヘッダー/サイドバー有無、画面サイズ |
| C3 | **操作的一貫性** | 操作パターンの統一 | ボタン配置、キーボードショートカット |
| C4 | **用語的一貫性** | ラベル・テキストの統一 | ボタン名、エラーメッセージ |

> **C2例外**: 画面の**位置づけ**（目的・役割）が根本的に異なる場合（例: ログイン画面 vs. ダッシュボード）、サイズ差・レイアウト差は許容される。

#### UI一貫性チェックリスト（必須）

- [ ] **C1 視覚的**: strokeColor / backgroundColor は既存画面と一致しているか
- [ ] **C1 視覚的**: roughness / fontFamily は既存画面と一致しているか
- [ ] **C2 構造的**: 同カテゴリ画面とヘッダー/サイドバー構成が一致しているか（例外条件確認）
- [ ] **C3 操作的**: ボタン配置パターン（右寄せ/中央）は統一されているか
- [ ] **C4 用語的**: 同じ機能のラベルは同じ文言になっているか

#### 既存画面参照テーブル（新規画面作成時記入）

```markdown
| 観点 | 新規画面 | 既存参照画面 | 一致/例外 |
|------|---------|-------------|:--------:|
| C1 strokeColor | #666666 | 01_login: #666666 | ✅ |
| C1 roughness | 1 | 01_login: 1 | ✅ |
| C2 画面サイズ | 1920×1080 | 01_login: 400×420 | 例外（位置づけ異なる） |
| C3 ボタン配置 | 右寄せ | 01_login: 中央 | 🟡 要確認 |
| C4 保存ボタン | 「保存」 | - | ✅ |
```

> **詳細**: UI_Design_Knowledge_Base.md §LV-002参照

---

### 設計確認（ワイヤーフレーム作成前必須）

> **⚠️ 重要**: 以下の確認をワイヤーフレーム作成**前**に実施すること。

- [ ] **UC図確認**: 該当UCの機能要件を確認した
- [ ] **業務フロー確認**: 該当セクションの業務フローを確認した
- [ ] **機能一覧表確認**: 該当機能ID（F-XXX-XX）の詳細を確認した
- [ ] **既存ワイヤーフレーム確認**: 類似画面のスタイルを参照した

**UC/業務フロー整合性テーブル（必須）**:

```markdown
| 確認項目 | 参照先 | 確認内容 | 確認 |
|---------|--------|---------|:----:|
| UC定義 | UC X-X | 機能要件 | ✅ |
| 業務フロー | §3.X | 処理フロー | ✅ |
| 機能一覧 | F-XXX-XX | 詳細仕様 | ✅ |
```

### TD-015原則確認

- [ ] 低精度（Low-Fidelity）を維持しているか
- [ ] 手書き風スタイルを適用しているか
- [ ] グレースケールのみ使用しているか
- [ ] 1画面15分以内で作成できる程度か

### UI要素配置確認

- [ ] 全ての必須UI要素が含まれているか
- [ ] 要素の論理的なグルーピングがされているか
- [ ] ナビゲーション要素が明確か
- [ ] アクセシビリティが考慮されているか

### 過剰詳細チェック（憲法 §3.4）

- [ ] ピクセル単位の配置調整をしていないか
- [ ] 詳細なアイコンデザインを含んでいないか
- [ ] カラーパレットを定義していないか
- [ ] フォントサイズの細かい調整をしていないか
- [ ] 30分以上かけていないか（目安15分/画面）

---

## 7. 5パスレビュー

### レビュープロセス

PNG生成後、以下の5パスで視覚的レビューを実施。

| Pass | 対象 | 確認内容 |
|:----:|------|---------|
| 1 | **TD-015準拠** | 低精度、手書き風、グレースケール |
| 2 | **網羅性** | 画面一覧チェックリスト照合 |
| 3 | **UI要素** | UC図・業務フロー図と照合 |
| 4 | **過剰詳細** | 「やりすぎ」チェック（憲法 §3.4） |
| 5 | **整合性** | 他画面との一貫性 |

### Pass 1: TD-015準拠確認

```markdown
| チェック項目 | 確認 | 備考 |
|-------------|:----:|------|
| グラデーションなし | ✅/🔴 | |
| ドロップシャドウなし | ✅/🔴 | |
| グレースケールのみ | ✅/🔴 | |
| 手書き風スタイル | ✅/🔴 | |
| 低精度維持 | ✅/🔴 | |
```

### Pass 4: 過剰詳細チェック

```markdown
| 過剰詳細項目 | 該当 | 対応 |
|-------------|:----:|------|
| ピクセル完璧配置 | ✅/🔴 | |
| 複雑なアイコン | ✅/🔴 | |
| 詳細なタイポグラフィ | ✅/🔴 | |
| 実装寄りの詳細 | ✅/🔴 | |
```

---

## 8. 採点基準

### Phase 1-A: ワイヤーフレーム採点

| カテゴリ | 配点 | 確認内容 |
|---------|:----:|---------|
| TD-015準拠 | 25 | 3原則遵守 |
| UC/業務フロー整合性 | 20 | 機能網羅性 |
| UI要素配置 | 20 | 論理的グルーピング |
| アクセシビリティ | 15 | 基本配慮 |
| 命名規則 | 10 | ファイル名・要素名 |
| 可読性 | 10 | 視認性・明瞭さ |
| **合計** | **100** | **90点以上で合格** |

### Phase 1-B: 画面遷移図採点

| カテゴリ | 配点 | 確認内容 |
|---------|:----:|---------|
| 網羅性 | 30 | 全画面ノード化 |
| 遷移完全性 | 25 | 孤立ノードなし |
| UC対応 | 20 | UC→遷移追跡可能 |
| 構文正確性 | 15 | PlantUML構文 |
| 可読性 | 10 | レイアウト・ラベル |
| **合計** | **100** | **90点以上で合格** |

---

## 9. 成果物保存

### 保存先

| 成果物 | 保存先 |
|--------|--------|
| ワイヤーフレーム（.excalidraw） | `docs/proposals/diagrams/10_wireframe/` |
| ワイヤーフレーム正式版（.svg） | `docs/proposals/diagrams/10_wireframe/` |
| 画面遷移図（.puml） | `docs/proposals/diagrams/09_screen_transition/` |
| 画面遷移図正式版（.svg） | `docs/proposals/diagrams/09_screen_transition/` |

### ⚠️ ワイヤーフレーム一覧管理（必須）

ワイヤーフレーム作成・更新後は、**必ず`00_wireframe_index.md`を更新すること**。

| 更新項目 | 内容 |
|---------|------|
| **進捗サマリー** | 完了数/残り/進捗率を更新 |
| **作成計画テーブル** | 該当画面の状況を✅に変更 |
| **完了済み画面セクション** | 新規画面の埋め込みリンク追加 |

> **参照**: UI_Design_Knowledge_Base.md §EX-005 Embedded Index Pattern
> **再発防止**: 本項目は2025-12-28の更新漏れ事例（Session 8）を受けて追加

### Evidence 3点セット

```
docs/evidence/yyyyMMdd_HHmm_ui_design_xxx/
├── instructions.md     # 作業指示
├── 00_raw_notes.md     # 作業メモ
└── work_sheet.md       # 作業結果・採点
```

---

## 10. 知見反映（セッション終了前必須）

> **参照**: UI設計図表開発憲法 v3.5

セッション終了前に以下を確認：

- [ ] **論理的妥当性検証の発見** → `UI_Design_Knowledge_Base.md` に **LV-XXX** として追加
- [ ] Excalidraw関連の発見 → `UI_Design_Knowledge_Base.md` に EX-XXX として追加
- [ ] State Diagram関連の発見 → `UI_Design_Knowledge_Base.md` に SD-XXX として追加
- [ ] TD-015適用の発見 → `UI_Design_Knowledge_Base.md` に TD-XXX として追加
- [ ] 整合性チェックの発見 → `UI_Design_Knowledge_Base.md` に IC-XXX として追加
- [ ] プロセス改善を発見 → `UI_Design_Constitution.md` を更新
- [ ] ガイドライン変更が必要 → 本ガイド（02_Authoring_Guide.md）を更新
- [ ] work_sheet.md に反映結果を記録

---

## 11. 参照ドキュメント

| ドキュメント | パス | 参照目的 |
|-------------|------|---------|
| **UI設計図表開発憲法** | `docs/guides/ui_design/UI_Design_Constitution.md` | 禁止事項、評価基準 |
| **セッション開始ガイド** | `docs/guides/ui_design/00_Session_Start.md` | 作業プロセス |
| **参照ガイド** | `docs/guides/ui_design/01_Reference_Guide.md` | ドキュメントナビ |
| 知見統合戦略 | `docs/guides/ui_design/03_Knowledge_Strategy.md` | 知見ID体系、追加フロー |
| **知見ベース** | `docs/guides/ui_design/UI_Design_Knowledge_Base.md` | EX/SD/TD/IC知見 |
| **設計パターンチェックリスト** | `docs/guides/ui_design/Design_Pattern_Checklist.md` | UIパターン確認 |
| **UI設計パターン集** | `docs/guides/ui_design/UI_Design_Patterns.md` | 実装パターン |
| **UC図** | `docs/proposals/02_ユースケース図_20251130.md` | 機能要件 |
| **業務フロー図** | `docs/proposals/03_業務フロー図_20251201.md` | 業務フロー詳細 |
| **機能一覧表** | `docs/proposals/05_機能一覧表_20251213.md` | UC番号、機能ID |
| **技術決定** | `docs/context/technical_decisions.md` | TD-015 |

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-12-28 | **§9 ワイヤーフレーム一覧管理（必須）追加**: `00_wireframe_index.md`更新要件を明記（更新漏れ防止対策）|
| 2025-12-27 | **§6 論理的妥当性検証（LV-001）追加**: 4原則チェックリスト、4段階検証フロー、違反例と対処。§10にLV-XXX知見反映項目追加 |
| 2025-12-27 | §4.5追加（フォルダ命名規則 番号プレフィックス方式）、§4.6追加（TD-015準拠設定値一覧）|
| 2025-12-27 | §4.4追加（ファイル構成 EX-005 Embedded Index Pattern）|
| 2025-12-22 | 初版作成 |
